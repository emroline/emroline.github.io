<!doctype html> <!-- Minimal Mistakes Jekyll Theme 4.17.2 by Michael Rose Copyright 2013-2019 Michael Rose - mademistakes.com | @mmistakes Free for personal and commercial use under the MIT license https://github.com/mmistakes/minimal-mistakes/blob/master/LICENSE --><html lang="en" class="no-js"><head><meta charset="utf-8"> <!-- begin _includes/seo.html --><title>Runge Kutta 4th Order Method To Solve Differential Equation Using Python - Emroline</title><meta name="description" content="Runge Kutta method is used to integrate differential equations iteratively using computer programs. Here we will implement it using Python."><meta name="author" content="Emroline"><meta property="og:type" content="article"><meta property="og:locale" content="en_US"><meta property="og:site_name" content="Emroline"><meta property="og:title" content="Runge Kutta 4th Order Method To Solve Differential Equation Using Python"><meta property="og:url" content="https://www.emroline.com/papers/runge-kutta-4th-order-method-to-solve-differential-equation"><meta property="og:description" content="Runge Kutta method is used to integrate differential equations iteratively using computer programs. Here we will implement it using Python."> <!-- Include noindex tag on pages with noindex: true --><meta property="article:published_time" content="2020-01-17T00:00:00+05:30"><link rel="canonical" href="https://www.emroline.com/papers/runge-kutta-4th-order-method-to-solve-differential-equation"> <script type="application/ld+json"> { "@context": "https://schema.org", "@type": "Person", "name": "Emroline", "url": "https://www.emroline.com/" } </script><meta name="google-site-verification" content="dqZ3Gba1UF4aNKM-3jpbb-8RvyaoQnulM1SNuPPoP-U" /> <!-- end _includes/seo.html --><link href="/feed.xml" type="application/atom+xml" rel="alternate" title="Emroline Feed"> <!-- https://t.co/dKP3o1e --><meta name="viewport" content="width=device-width, initial-scale=1.0"> <script> document.documentElement.className = document.documentElement.className.replace(/\bno-js\b/g, '') + ' js '; </script> <!-- For all browsers --><link rel="stylesheet" href="/assets/css/main.css"> <!--[if IE]><style> /* old IE unsupported flexbox fixes */ .greedy-nav .site-title { padding-right: 3em; } .greedy-nav button { position: absolute; top: 0; right: 0; height: 100%; }</style><![endif]--> <!-- start custom head snippets --> <!-- insert favicons. use https://realfavicongenerator.net/ --><link rel="apple-touch-icon" sizes="180x180" href="/assets/images/icons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/images/icons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/images/icons/favicon-16x16.png"><link rel="manifest" href="/assets/images/icons/site.webmanifest"><link rel="mask-icon" href="/assets/images/icons/safari-pinned-tab.svg" color="#5bbad5"><link rel="shortcut icon" href="/assets/images/icons/favicon.ico"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/images/icons/browserconfig.xml"><meta name="theme-color" content="#ffffff"> <script type="text/x-mathjax-config"> MathJax.Hub.Config({ tex2jax: { inlineMath: [ ['$','$'], ['\(', '\)'] ], displayMath: [ ['$$','$$'] ], processEscapes: true, } }); </script> <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script> <script data-ad-client="ca-pub-4710272970907206" async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script> <!-- end custom head snippets --></head><body class="layout--single"><nav class="skip-links"><h2 class="screen-reader-text">Skip links</h2><ul><li><a href="#site-nav" class="screen-reader-shortcut">Skip to primary navigation</a></li><li><a href="#main" class="screen-reader-shortcut">Skip to content</a></li><li><a href="#footer" class="screen-reader-shortcut">Skip to footer</a></li></ul></nav><!--[if lt IE 9]><div class="notice--danger align-center" style="margin: 0;">You are using an <strong>outdated</strong> browser. Please <a href="https://browsehappy.com/">upgrade your browser</a> to improve your experience.</div><![endif]--><div class="masthead"><div class="masthead__inner-wrap"><div class="masthead__menu"><nav id="site-nav" class="greedy-nav"> <a class="site-logo" href="/"><img src="/assets/images/favicon.png" alt=""></a> <a class="site-title" href="/"> Emroline <span class="site-subtitle">Explore And Learn</span> </a><ul class="visible-links"><li class="masthead__menu-item"> <a href="/journals/python/" title="Python Programming Tutorial">Python</a></li><li class="masthead__menu-item"> <a href="/journals/android/" title="Android Development Tutorial">Android</a></li><li class="masthead__menu-item"> <a href="/journals/flutter/" title="Flutter Tutorial">Flutter</a></li><li class="masthead__menu-item"> <a href="/journals/data-structures/" title="Learn about Data Structures">Data Structures</a></li><li class="masthead__menu-item"> <a href="/journals/space-science/" title="Learn Space Science">Space Science</a></li></ul><button class="greedy-nav__toggle hidden" type="button"> <span class="visually-hidden">Toggle menu</span><div class="navicon"></div></button><ul class="hidden-links hidden"></ul></nav></div></div></div><div class="initial-content"><div id="main" role="main"><div class="sidebar sticky"><nav class="nav__list"> <input id="ac-toc" name="accordion-toc" type="checkbox" /> <label for="ac-toc">Toggle menu</label><ul class="nav__items"><li> <a href="/journals/space-science/"><span class="nav__sub-title">Space Science</span></a></li><li> <a href="/journals/python/"><span class="nav__sub-title">Python</span></a></li><li> <a href="/journals/android/"><span class="nav__sub-title">Android</span></a></li><li> <a href="/journals/flutter/"><span class="nav__sub-title">Flutter</span></a></li><li> <a href="/journals/algorithms/"><span class="nav__sub-title">Algorithms</span></a></li><li> <a href="/journals/data-structures/"><span class="nav__sub-title">Data Structures</span></a></li><li> <a href="/journals/miscellaneous/"><span class="nav__sub-title">Miscellaneous</span></a></li></ul></nav></div><article class="page" itemscope itemtype="https://schema.org/CreativeWork"><meta itemprop="headline" content="Runge Kutta 4th Order Method To Solve Differential Equation Using Python"><meta itemprop="description" content="Runge Kutta method is used to integrate differential equations iteratively using computer programs. Here we will implement it using Python."><meta itemprop="datePublished" content="January 17, 2020"><div class="page__inner-wrap"><header><h1 id="page-title" class="page__title" itemprop="headline">Runge Kutta 4th Order Method To Solve Differential Equation Using Python</h1></header><section class="page__content" itemprop="text"> <!-- if page.advertisment is true then show advertisment --> <!-- If page.under_development == true add this notice below header--><p>If we have following input:</p><ul><li>Ordinary differential equation that defines value of dy/dx in the form x and y.</li><li>Initial value of y, ie., y(0)</li></ul><p>Thus we have:</p><script type="math/tex; mode=display">\frac{dx}{dy} = f(x,y) \\y(0) = y_0</script><p>So our task is to find the value of unknown y at a given point x.</p><p>The Runge-Kutta method finds approximate value of y for a given x. Only first order ordinary differential equations can be solved by using the Runge Kutta 4th order method.</p><p>Below is the formula used to compute next value yn+1 from previous value yn. The value of n are 0, 1, 2, 3, ….(x – x0)/h. Here <strong>h is step height</strong> and <strong><script type="math/tex">x_{n+1} = x_0 + h</script></strong>. Lower step size means more accuracy.</p><script type="math/tex; mode=display">k_1 = hf(x_n,y_n) \\k_2 = hf(x_n + h/2,y_n + k_1/2) \\k_3 = hf(x_n + h/2,y_n + k_2/2) \\k_4 = hf(x_n + h,y_n + k_3) \\y_{n+1} = y_n + k_1/6 + k_2/3 + k_3/3 + k_4/6 + O(h^5)</script><p>The formula basically computes next value <script type="math/tex">y_{n+1}</script> using current <script type="math/tex">y_n</script> plus weighted average of four increments.</p><p><script type="math/tex">k_1</script> is the increment based on the slope at the beginning of the interval, using y</p><p><script type="math/tex">k_2</script> is the increment based on the slope at the midpoint of the interval, using <script type="math/tex">y + hk_1/2</script>.</p><p><script type="math/tex">k_3</script> is again the increment based on the slope at the midpoint, using using <script type="math/tex">y + hk_2/2</script>.</p><p><script type="math/tex">k_4</script> is the increment based on the slope at the end of the interval, using <script type="math/tex">y + hk_3</script>.</p><p>The method is a fourth-order method, meaning that the local truncation error is on the order of <script type="math/tex">O(h^5)</script>, while the total accumulated error is order <script type="math/tex">O(h^4)</script>.</p><p>Sources:</p><ul><li><a href="https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods">https://en.wikipedia.org/wiki/Runge%E2%80%93Kutta_methods</a></li><li><a href="https://rosettacode.org/wiki/Runge-Kutta_method#Python">https://rosettacode.org/wiki/Runge-Kutta_method#Python</a></li></ul><p>Below is Python implementation for the above formula.</p><figure class="highlight"><pre><code class="language-python" data-lang="python"><span class="c1"># Python implementation of Runge Kutta method 
# A sample differential equation "dy / dx = (x - y)/2" 
</span><span class="k">def</span> <span class="nf">dydx</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span> 
    <span class="k">return</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span> 
  
<span class="c1"># Finds value of y for a given x using step size h 
# and initial value y0 at x0. 
</span><span class="k">def</span> <span class="nf">rungeKutta</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y0</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">):</span> 
    <span class="c1"># Count number of iterations using step size or 
</span>    <span class="c1"># step height h 
</span>    <span class="n">n</span> <span class="o">=</span> <span class="p">(</span><span class="nb">int</span><span class="p">)((</span><span class="n">x</span> <span class="o">-</span> <span class="n">x0</span><span class="p">)</span><span class="o">/</span><span class="n">h</span><span class="p">)</span>  
    <span class="c1"># Iterate for number of iterations 
</span>    <span class="n">y</span> <span class="o">=</span> <span class="n">y0</span> 
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span> 
        <span class="s">"Apply Runge Kutta Formulas to find next value of y"</span>
        <span class="n">k1</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">dydx</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> 
        <span class="n">k2</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">dydx</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k1</span><span class="p">)</span> 
        <span class="n">k3</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">dydx</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="mf">0.5</span> <span class="o">*</span> <span class="n">k2</span><span class="p">)</span> 
        <span class="n">k4</span> <span class="o">=</span> <span class="n">h</span> <span class="o">*</span> <span class="n">dydx</span><span class="p">(</span><span class="n">x0</span> <span class="o">+</span> <span class="n">h</span><span class="p">,</span> <span class="n">y</span> <span class="o">+</span> <span class="n">k3</span><span class="p">)</span> 
  
        <span class="c1"># Update next value of y 
</span>        <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">+</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">6.0</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">k1</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">k2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">k3</span> <span class="o">+</span> <span class="n">k4</span><span class="p">)</span> 
  
        <span class="c1"># Update next value of x 
</span>        <span class="n">x0</span> <span class="o">=</span> <span class="n">x0</span> <span class="o">+</span> <span class="n">h</span> 
    <span class="k">return</span> <span class="n">y</span> 
  
<span class="c1"># Driver method 
</span><span class="n">x0</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">y</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">h</span> <span class="o">=</span> <span class="mf">0.2</span>
<span class="k">print</span> <span class="s">'The value of y at x is:'</span><span class="p">,</span> <span class="n">rungeKutta</span><span class="p">(</span><span class="n">x0</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">h</span><span class="p">)</span>   </code></pre></figure><p>The output:</p><figure class="highlight"><pre><code class="language-terminal" data-lang="terminal"><span class="go">The value of y at x is: 1.103639</span></code></pre></figure><p>Time Complexity of above solution is O<script type="math/tex">(n)</script> where n is <script type="math/tex">(x-x0)/h</script>.</p><p>Some useful resources for detailed examples and more explanation. <a href="http://w3.gazi.edu.tr/~balbasi/mws_gen_ode_txt_runge4th.pdf">http://w3.gazi.edu.tr/~balbasi/mws_gen_ode_txt_runge4th.pdf</a></p><p><a href="https://www.youtube.com/watch?v=kUcc8vAgoQ0">https://www.youtube.com/watch?v=kUcc8vAgoQ0</a></p></section><footer class="page__meta"><p class="page__taxonomy"> <strong><i class="fas fa-fw fa-tags" aria-hidden="true"></i> Tags: </strong> <span itemprop="keywords"> <a href="/tags/#algorithms" class="page__taxonomy-item" rel="tag">Algorithms</a><span class="sep">, </span> <a href="/tags/#featured" class="page__taxonomy-item" rel="tag">featured</a><span class="sep">, </span> <a href="/tags/#physics" class="page__taxonomy-item" rel="tag">Physics</a> </span></p><p class="page__taxonomy"> <strong><i class="fas fa-fw fa-folder-open" aria-hidden="true"></i> Categories: </strong> <span itemprop="keywords"> <a href="/categories/#python-examples" class="page__taxonomy-item" rel="tag">Python Examples</a><span class="sep">, </span> <a href="/categories/#python" class="page__taxonomy-item" rel="tag">Python</a> </span></p><p class="page__date"><strong><i class="fas fa-fw fa-calendar-alt" aria-hidden="true"></i> Updated:</strong> <time datetime="2020-01-17T00:00:00+05:30">January 17, 2020</time></p><!-- Contributer --></footer><nav class="pagination"> <a href="#" class="pagination--pager disabled">Previous</a> <a href="/papers/how-to-use-mathjax-to-write-math-equations-in-jekyll-blogs" class="pagination--pager" title="How To Use Mathjax To Write Math Equations In Jekyll Blogs ">Next</a></nav></div></article><div class="page__related"><h4 class="page__related-title">You may also enjoy</h4><div class="grid__wrapper"><div class="grid__item"><article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork"><h2 class="archive__item-title" itemprop="headline"> <a href="/papers/how-to-pass-command-line-arguments-in-python-using-argparse-module" rel="permalink">How To Pass Command Line Arguments In Python Using argparse Module </a></h2><p class="archive__item-excerpt" itemprop="description">Python provides an argparse module, which makes it easy to write user-friendly command-line interfaces. In a program you can define the required arguments, a...</p></article></div><div class="grid__item"><article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork"><h2 class="archive__item-title" itemprop="headline"> <a href="/papers/how-to-get-user-input-in-python" rel="permalink">How To Get User Input In Python </a></h2><p class="archive__item-excerpt" itemprop="description">While writing our Python programs, many times we need to get input from user. Python makes it very easy for us to get user input. Python3 provides an inbuil...</p></article></div><div class="grid__item"><article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork"><h2 class="archive__item-title" itemprop="headline"> <a href="/papers/what-are-the-benefits-of-using-flutter" rel="permalink">What Are The Benefits Of Using Flutter </a></h2><p class="archive__item-excerpt" itemprop="description"> Flutter saves your time and money Flutter is a cross-platform development tool. That means once you build your application using Flutter, you can use the...</p></article></div><div class="grid__item"><article class="archive__item" itemscope itemtype="https://schema.org/CreativeWork"><h2 class="archive__item-title" itemprop="headline"> <a href="/papers/introduction-to-dart-programming" rel="permalink">Introduction To Dart Programming </a></h2><p class="archive__item-excerpt" itemprop="description"> Dart is an open-source general-purpose programming language. Dart is an object oriented language. Following is a simple Dart program that prints some tex...</p></article></div></div></div></div></div><div id="footer" class="page__footer"><footer> <!-- start custom footer snippets --> <!-- end custom footer snippets --> <!--<div class="page__footer-follow"><ul class="social-icons"><li><strong>Follow:</strong></li><li><a href="/feed.xml"><i class="fas fa-fw fa-rss-square" aria-hidden="true"></i> Feed</a></li></ul></div>--><div class="page__footer-follow"><ul class="social-icons"><li><a href="/" rel="nofollow noopener noreferrer"><i class="fas fa-link" aria-hidden="true"></i> Home</a></li><li><a href="/journals/python/" rel="nofollow noopener noreferrer"><i class="fas fa-link" aria-hidden="true"></i> Python</a></li><li><a href="/journals/android/" rel="nofollow noopener noreferrer"><i class="fas fa-link" aria-hidden="true"></i> Android</a></li><li><a href="/journals/flutter/" rel="nofollow noopener noreferrer"><i class="fas fa-link" aria-hidden="true"></i> Flutter</a></li><li><a href="/journals/data-structures/" rel="nofollow noopener noreferrer"><i class="fas fa-link" aria-hidden="true"></i> Data Structures</a></li><li><a href="/journals/algorithms/" rel="nofollow noopener noreferrer"><i class="fas fa-link" aria-hidden="true"></i> Algorithms</a></li><li><a href="/journals/space-science/" rel="nofollow noopener noreferrer"><i class="fas fa-link" aria-hidden="true"></i> Space Science</a></li><li><a href="/contribute/" rel="nofollow noopener noreferrer"><i class="fas fa-link" aria-hidden="true"></i> Contribute</a></li><li><a href="/about/" rel="nofollow noopener noreferrer"><i class="fas fa-link" aria-hidden="true"></i> About Us</a></li><li><a href="/contact/" rel="nofollow noopener noreferrer"><i class="fas fa-link" aria-hidden="true"></i> Contact</a></li></ul></div><div class="page__footer-copyright text-center">&copy; 2020 Emroline. All Rights Reserved.</div></footer></div><script src="/assets/js/main.min.js"></script> <script src="https://kit.fontawesome.com/4eee35f757.js"></script> <script> window.ga=function(){ga.q.push(arguments)};ga.q=[];ga.l=+new Date; ga('create','UA-154708769-1','auto'); ga('set', 'anonymizeIp', true); ga('send','pageview') </script> <script src="https://www.google-analytics.com/analytics.js" async></script></body></html>
